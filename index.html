<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Fluent</title>
  </head>
  <body>
    <form id="form">
      <label for="word" aria-label="Mot du patient">Mot du patient :</label>
      <input type="text" name="word" id="word" />
      <button type="submit">Ok</button>
    </form>

    <div class="results">
      <div id="wordList">
        <p>Nombre de mots : <span class="counter">0</span></p>

        <div>
          <p>Liste des mots :</p>
          <ul class="list"></ul>
        </div>
      </div>
      <div id="duplicateList">
        <p>Nombre de doublons : <span class="counter">0</span></p>

        <div>
          <p>Liste des doublons :</p>
          <ul class="list"></ul>
        </div>
      </div>
    </div>

    <script>
      (function IIFE() {
        var form = document.getElementById('form');
        var input = document.getElementById('word');

        var wordCounterNode = document.querySelector('#wordList .counter');
        var wordListNode = document.querySelector('#wordList .list');

        var duplicateCounterNode = document.querySelector('#duplicateList .counter');
        var duplicateListNode = document.querySelector('#duplicateList .list');

        var allWords = [];
        var duplicates = [];

        /**
         * Adds a word in the correct `ul` element regarding context.
         *
         * @param {string} context Where to append the word.
         * @param {string} value   The value to display.
         */
        function addWordToList(context, value) {
          var list = context === 'word' ? wordListNode : duplicateListNode;
          var counter = context === 'word' ? wordCounterNode : duplicateCounterNode;

          var li = document.createElement('li');
          li.appendChild(document.createTextNode(value));
          list.appendChild(li);

          counter.textContent = parseInt(counter.textContent, 10) + 1;
        }

        /**
         * Handles the form submit.
         *
         * @param {Event} event The form sumbit Event object.
         */
        function handleSubmit(event) {
          // Prevents page from reloading.
          event.preventDefault();

          // Get word from input.
          var value = input.value.toLowerCase();

          if (!value || !value.length) {
            return;
          }

          if (allWords.includes(value)) {
            if (!duplicates.includes(value)) {
              duplicates.push(value);
              addWordToList('duplicate', value);
            }
          } else {
            allWords.push(value);
            addWordToList('word', value);
          }

          // Clear input.
          input.value = null;
        }

        // Attach `onsubmit` form method `handleSubmit` function.
        form.onsubmit = handleSubmit;
      })();
    </script>
  </body>
</html>
